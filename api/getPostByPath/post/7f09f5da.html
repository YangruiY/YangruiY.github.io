{"type":"getPostByPath","data":{"title":"Spring5","date":"2023-09-13T15:44:04.000Z","description":"面试精选","categories":[{"name":"FaceToFace","_id":"clo9tj5ve001bl10phwsc3bgw"}],"tags":[{"name":"Spring5","_id":"clo9tj5w3006ll10p2kg342bu"}],"content":"<meta name=\"referrer\" content=\"no-referrer\">\n\n<h2 id=\"Spring5\"><a href=\"#Spring5\" class=\"headerlink\" title=\"Spring5\"></a>Spring5</h2><h3 id=\"Spring-Framework\"><a href=\"#Spring-Framework\" class=\"headerlink\" title=\"Spring Framework\"></a>Spring Framework</h3><ul>\n<li><p>Spring 基础框架</p>\n</li>\n<li><p>特征</p>\n<ul>\n<li>非侵入式：基于 Spring Framework 开发应用程序时结构清晰、简洁优雅</li>\n<li>控制反转：IOC——Inversion of Control，把创建对象的权利交给Spring 进行管理。</li>\n<li>面向切面编程：AOP——Aspect Oriented Programming，在不修改源代码的基础上横向增强代码功能。</li>\n<li>容器：Spring IOC 是一个容器，因为它包含并且管理组件对象的生命周期。组件享受到了容器化的管理，替程序员屏蔽了组件创建过程中的大量细节，极大的降低了使用门槛，大幅度提高了开发效率。</li>\n<li>组件化：Spring 实现了使用简单的组件配置组合成一个复杂的应用。在 Spring 中可以使用 XML和 Java 注解组合这些对象。</li>\n<li>声明式：只需要声明需求即可由框架代为实现。</li>\n<li>一站式：在 IOC 和 AOP 的基础上可以整合各种企业应用的开源框架和优秀的第三方类库。</li>\n</ul>\n</li>\n<li>五大功能模块</li>\n</ul>\n<div class=\"table-container\">\n<table>\n<thead>\n<tr>\n<th>功能模块</th>\n<th>功能介绍</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Core Container</td>\n<td>核心容器，在 Spring 环境下使用任何功能都必须基于 IOC 容器</td>\n</tr>\n<tr>\n<td>AOP&amp;Aspects</td>\n<td>面向切面编程</td>\n</tr>\n<tr>\n<td>Testing</td>\n<td>提供了对 junit 或 TestNG 测试框架的整合</td>\n</tr>\n<tr>\n<td>Data Access/Integration</td>\n<td>提供了对数据访问/集成的功能</td>\n</tr>\n<tr>\n<td>Spring MVC</td>\n<td>提供了面向Web应用程序的集成功能</td>\n</tr>\n</tbody>\n</table>\n</div>\n<h3 id=\"spring的思想\"><a href=\"#spring的思想\" class=\"headerlink\" title=\"spring的思想\"></a>spring的思想</h3><ul>\n<li>将 自定义的组件 配置到 Spring配置文件中，然后由spring 的 IOC容器对象进行创建组件对象</li>\n</ul>\n<h3 id=\"IOC\"><a href=\"#IOC\" class=\"headerlink\" title=\"IOC\"></a>IOC</h3><ul>\n<li>是什么： 就是将创建对象的权利和对象之间的调用过程交给 Spring 进行管理</li>\n<li><p>作用：为了耦合度降低，使得开发人员不用在意底层的容器如何创建对象，只要关注如何进行接受资源就可以了</p>\n</li>\n<li><p>技术实现：<code>DI</code>：Dependency Injection，依赖注入。DI 是 IOC 的具体实现：组件以一些预先定义好的方式（例如：setter 方法）接受来自于容器的资源注入。相对于IOC而言，这种表述更直接。</p>\n</li>\n<li><p>在Spring中的实现：IOC 容器，其管理的组件就叫 bean</p>\n</li>\n<li>实现方式：<ul>\n<li>BeanFactory:内部接口，<code>加载</code>配置文件时候<code>不会</code>创建对象，在<code>获取对象（使用）才去创建对象</code></li>\n<li>ApplicationContext ：BeanFactory子接口，开发人员使用,<code>加载</code>配置文件时候<code>就会</code>把在配置文件对象进行<code>创建</code></li>\n</ul>\n</li>\n<li>ApplicationContext主要实现类</li>\n</ul>\n<div class=\"table-container\">\n<table>\n<thead>\n<tr>\n<th>类型名</th>\n<th>简介</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ClassPathXmlApplicationContext</td>\n<td>通过读取类路径下的 XML 格式的配置文件创建 IOC 容器对象</td>\n</tr>\n<tr>\n<td>FileSystemXmlApplicationContext</td>\n<td>通过文件系统路径读取 XML 格式的配置文件创建 IOC 容器对象</td>\n</tr>\n<tr>\n<td>ConfigurableApplicationContext</td>\n<td>ApplicationContext 的子接口，包含一些扩展方法refresh() 和 close() ，<br>让 ApplicationContext 具有启动、关闭和刷新上下文的能力。</td>\n</tr>\n<tr>\n<td>WebApplicationContext</td>\n<td>专门为 Web 应用准备，基于 Web 环境创建 IOC 容器对象，并将对象引入存入 ServletContext 域中。</td>\n</tr>\n</tbody>\n</table>\n</div>\n<ul>\n<li>==底层原理：==</li>\n</ul>\n<h4 id=\"IOC操作Bean管理：\"><a href=\"#IOC操作Bean管理：\" class=\"headerlink\" title=\"IOC操作Bean管理：\"></a>IOC操作Bean管理：</h4><h6 id=\"1、Spring-创建对象\"><a href=\"#1、Spring-创建对象\" class=\"headerlink\" title=\"1、Spring 创建对象\"></a>1、Spring 创建对象</h6><h6 id=\"2、Spirng-注入属性\"><a href=\"#2、Spirng-注入属性\" class=\"headerlink\" title=\"2、Spirng 注入属性\"></a>2、Spirng 注入属性</h6><blockquote>\n<p>Bean 管理指的是<code>两个操作</code>  :Spring 创建对象  + Spirng 注入属性    ;  <code>两种实现的方式</code> : 基于 xml 配置文件方式实现   + 基于注解方式实现</p>\n</blockquote>\n<h4 id=\"基于XML-的方式\"><a href=\"#基于XML-的方式\" class=\"headerlink\" title=\"基于XML  的方式\"></a>基于XML  的方式</h4><h5 id=\"创建对象\"><a href=\"#创建对象\" class=\"headerlink\" title=\"创建对象\"></a>创建对象</h5><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--  配置HelloWorld所对应的bean，即将HelloWorld的对象交给Spring的IOC容器管理    通过bean标签配置IOC容器所管理的bean </span></span><br><span class=\"line\"><span class=\"comment\">\t\t属性：\t</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\tid：设置bean的唯一标识</span></span><br><span class=\"line\"><span class=\"comment\"> \t\t\tclass：设置bean所对应类型的全类名  --&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--配置 User 对象创建，创建的时候默认使用的是无参的构造器--&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;user&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;com.atguigu.spring5.User&quot;</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"> <span class=\"comment\">&lt;!-- set 的方式注入属性   使用 property 完成属性注入 \t\t name：类里面属性名称 value：向属性注入的值 \t\t  --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;name&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;易筋经&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;author&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;达摩&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"> <span class=\"comment\">&lt;!-- 有参数构造注入属性    name：类里面属性名称 value：向属性注入的值   index属性：指定参数所在位置的索引（从0开始）  --&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">constructor-arg</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;name&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;电脑&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">constructor-arg</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">constructor-arg</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;address&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;China&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">constructor-arg</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span> </span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"comment\">//2 获取配置创建的对象 </span></span><br><span class=\"line\"><span class=\"comment\">//此处获取bean有下面三种方式</span></span><br><span class=\"line\"><span class=\"comment\">//方式一：根据id获取：由于 id 属性指定了 bean 的唯一标识，所以根据 bean 标签的 id 属性可以精确获取到一个组件对象。</span></span><br><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> (User) ac.getBean(<span class=\"string\">&quot;user&quot;</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">//方式二：根据类型获取： 当根据类型获取bean时，要求IOC容器中指定类型的bean有且只能有一个</span></span><br><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> context.getBean(User.class);  </span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">//方式三：根据id和类型     --主流方式</span></span><br><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> context.getBean(<span class=\"string\">&quot;user&quot;</span>, User.class); </span><br></pre></td></tr></table></figure>\n<ol>\n<li>如果组件类实现了接口，根据<code>接口类型</code>可以获取 bean 吗？————————可以，<code>前提是bean唯一</code></li>\n<li>如果一个接口有<code>多个实现类</code>，这些实现类都配置了 bean，根据接口类型可以获取 bean 吗？————————不行，因为bean不唯一</li>\n<li>根据类型来获取bean时，在满足<code>bean唯一性</code>的前提下，其实只是看：『<code>对象</code> instanceof  <code>指定的类型</code>』的返回结果，只要返回的是true就可以认定为和类型匹配，能够获取到。</li>\n</ol>\n<h5 id=\"注入属性\"><a href=\"#注入属性\" class=\"headerlink\" title=\"注入属性\"></a>注入属性</h5><ol>\n<li>DI 依赖的方式注入属性</li>\n</ol>\n<p>​        1.1 先使用<code>set</code>的方式       setXxxx()    ，后在Bean之间使用property 的方式  配置属性注入       <code>&lt;property name=&quot;name&quot; value=&quot;易筋经&quot;&gt;&lt;/property&gt;</code></p>\n<p>​        1.2 先使用有<code>参构造器</code> 的方式注入， 后在Bean之间使用constructor-arg 的方式配置属性注入 <code>&lt;constructor-arg name=&quot;address&quot; value=&quot;China&quot;&gt;&lt;/constructor-arg&gt;</code></p>\n<ol>\n<li>p命名空间的注入</li>\n</ol>\n<p>​        2.1 添加p的名称空间；<code>xmlns:p=&quot;http://www.springframework.org/schema/p&quot;</code></p>\n<p>​        2.2 在bean 的标签中属性注入 <code>&lt;!--p名称空间注入--&gt;        &lt;bean id=&quot;book&quot; class=&quot;demo1.ry.Book&quot; p:name=&quot;红楼梦&quot; p:author=&quot;曹雪芹&quot;&gt;&lt;/bean&gt;</code></p>\n<h5 id=\"注入其他类型属性\"><a href=\"#注入其他类型属性\" class=\"headerlink\" title=\"注入其他类型属性\"></a>注入其他类型属性</h5><ol>\n<li><p>字面量： 不是一个变量，是字母本身，没有其他引申含义</p>\n<ol>\n<li>为类类型属性赋值： 注入外部bean</li>\n<li>为类类型属性赋值： 注入内部bean</li>\n<li>为类类型属性赋值：级联赋值</li>\n</ol>\n</li>\n</ol>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">------字面量</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--1.1 null 值--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;address&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">null</span>/&gt;</span>   <span class=\"comment\">&lt;!--含义就是为name赋值为null--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 1.2 属性值包含特殊符号;小于号在XML文档中用来定义标签的开始，不能随便使用</span></span><br><span class=\"line\"><span class=\"comment\">          1.2.1 把&lt;&gt;进行转义 &amp;lt; &amp;gt进行使用 eg:&lt;property name=&quot;expression&quot; value=&quot;a &amp;lt; b&quot;/&gt;</span></span><br><span class=\"line\"><span class=\"comment\">          1.2.2 把带特殊符号内容写到 CDATA节:</span></span><br><span class=\"line\"><span class=\"comment\">          CDATA中的C代表Character，是文本、字符的含义，CDATA就表示纯文本数据</span></span><br><span class=\"line\"><span class=\"comment\">          XML解析器看到CDATA节就知道这里是纯文本，就不会当作XML标签或属性来解析</span></span><br><span class=\"line\"><span class=\"comment\">          所以CDATA节中写什么符号都随意</span></span><br><span class=\"line\"><span class=\"comment\">    --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;address&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>&lt;![CDATA[&lt;&lt;南京&gt;&gt;]]&gt;<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span> </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">------注入外部bean</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;userService&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;demo1.ry.service.UserService&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--注入 userDao 对象</span></span><br><span class=\"line\"><span class=\"comment\">         name 属性：类里面属性名称</span></span><br><span class=\"line\"><span class=\"comment\">         ref 属性：创建 userDao 对象 bean 标签 id 值</span></span><br><span class=\"line\"><span class=\"comment\">         --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;userDao&quot;</span> <span class=\"attr\">ref</span>=<span class=\"string\">&quot;userDaoImple&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;userDaoImple&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;demo1.ry.Dao.UserDaoImple&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">------注入内部bean</span><br><span class=\"line\"><span class=\"comment\">&lt;!--一对多关系：部门和员工；员工表示所属部门，使用对象类型属性进行表示--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;emp&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;demo1.ry.innerBean.Emp&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--设置两个普通属性--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;name&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;lucy&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;gender&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;女&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--设置对象类型属性   部门类--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;dept&quot;</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;dept&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;demo1.ry.innerBean.dept&quot;</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;name&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;安保部&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">----级联赋值   <span class=\"comment\">&lt;!--（1）第一种写法--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;emp&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;demo1.ry.innerBean.Emp&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--设置两个普通属性--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;name&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;lucy&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;gender&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;女&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--级联赋值--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;dept&quot;</span> <span class=\"attr\">ref</span>=<span class=\"string\">&quot;dept&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;dept&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;demo1.ry.innerBean.dept&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;name&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;财务部&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">----级联赋值 <span class=\"comment\">&lt;!--（2）第二种写法    emp类中需要getDept()的方法   --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;emp&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;demo1.ry.innerBean.Emp&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--设置两个普通属性--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;name&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;lucy&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;gender&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;女&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--级联赋值--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;dept&quot;</span> <span class=\"attr\">ref</span>=<span class=\"string\">&quot;dept&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;dept.name&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;技术部&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;dept&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;demo1.ry.innerBean.dept&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h5 id=\"注入集合属性\"><a href=\"#注入集合属性\" class=\"headerlink\" title=\"注入集合属性\"></a>注入集合属性</h5><p>1、注入set集合类型属性</p>\n<p>2、注入List集合类型属性</p>\n<p>3、注入Map集合类型属性</p>\n<p>4、注入数组类型属性</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"comment\">&lt;!--1 集合类型属性注入--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;stu&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;demo2.ry.collectionType.Stu&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--数组类型属性注入--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;courses&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">array</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>java 课程<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>数据库课程<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">array</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--list 类型属性注入--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;list&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">list</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>张三<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>李四<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">list</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--map 类型属性注入--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;maps&quot;</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">map</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">entry</span> <span class=\"attr\">key</span>=<span class=\"string\">&quot;JAVA&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;java课程&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">entry</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">entry</span> <span class=\"attr\">key</span>=<span class=\"string\">&quot;PHP&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;php课程&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">entry</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">map</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--set 类型属性注入--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;sets&quot;</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">set</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>MySQL<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>Redis<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">set</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        </span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 对象类型注入--&gt;</span>   </span><br><span class=\"line\">        <span class=\"comment\">&lt;!--注入 list 集合类型，值是对象--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;courseList&quot;</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">list</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">ref</span> <span class=\"attr\">bean</span>=<span class=\"string\">&quot;course1&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ref</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">ref</span> <span class=\"attr\">bean</span>=<span class=\"string\">&quot;course2&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ref</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">list</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!--在集合里面设置对象类型值--&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--创建多个 course 对象--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;course1&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;demo2.ry.collectionType.Course&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;courseName&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;Spring5 框架&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;course2&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;demo2.ry.collectionType.Course&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;courseName&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;MyBatis 框架&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h6 id=\"取出集合注入部分的属性\"><a href=\"#取出集合注入部分的属性\" class=\"headerlink\" title=\"取出集合注入部分的属性\"></a>取出集合注入部分的属性</h6><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.springframework.org/schema/util/spring-util.xsd</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!--使用 util 标签完成 list 集合注入提取     提取 list 集合类型属性注入--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">util:list</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;bookList&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>红楼梦<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>西游记<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>三国演义<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>水浒传<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">util:list</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 提取 list 集合类型属性注入使用--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;book&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;demo2.ry.collectionType.Book&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;list&quot;</span> <span class=\"attr\">ref</span>=<span class=\"string\">&quot;bookList&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h5 id=\"基于xml-自动装配\"><a href=\"#基于xml-自动装配\" class=\"headerlink\" title=\"基于xml 自动装配\"></a>基于xml 自动装配</h5><ol>\n<li><p>什么是自动装配：    就是根据<code>指定装配规则</code>（属性名称或者属性类型），Spring 自动将匹配的属性值进行注入</p>\n</li>\n<li><p>自动装配的方式</p>\n<p>1）根据属性<code>名称</code>自动注入</p>\n<p>2）根据属性<code>类型</code>自动注入</p>\n</li>\n</ol>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"comment\">&lt;!--实现自动装配</span></span><br><span class=\"line\"><span class=\"comment\">bean 标签属性 autowire，配置自动装配</span></span><br><span class=\"line\"><span class=\"comment\">     autowire 属性常用两个值：</span></span><br><span class=\"line\"><span class=\"comment\">     \tbyName 根据属性名称注入 ，注入值 bean 的 id 值和类属性名称一样</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\t\tbyName：将自动装配的属性的属性名，作为bean的id在IOC容器中匹配相对应的bean进行赋值</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">     \tbyType 根据属性类型注入，但是不能有多个bean</span></span><br><span class=\"line\"><span class=\"comment\">        byType：根据类型匹配IOC容器中的某个兼容类型的bean，为属性自动赋值</span></span><br><span class=\"line\"><span class=\"comment\">        若在IOC中，没有任何一个兼容类型的bean能够为属性赋值，则该属性不装配，即值为默认值null</span></span><br><span class=\"line\"><span class=\"comment\">        若在IOC中，有多个兼容类型的bean能够为属性赋值，则抛出异常NoUniqueBeanDefinitionException    --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;emp&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;demo3.ry.atuoWrite.Emp&quot;</span> <span class=\"attr\">autowire</span>=<span class=\"string\">&quot;byName&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;dept&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;demo3.ry.atuoWrite.Dept&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;emp&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;demo3.ry.atuoWrite.Emp&quot;</span> <span class=\"attr\">autowire</span>=<span class=\"string\">&quot;byType&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;dept&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;demo3.ry.atuoWrite.Dept&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h5 id=\"IOC管理外部属性文件\"><a href=\"#IOC管理外部属性文件\" class=\"headerlink\" title=\"IOC管理外部属性文件\"></a>IOC管理外部属性文件</h5><h6 id=\"配置数据库连接池\"><a href=\"#配置数据库连接池\" class=\"headerlink\" title=\"配置数据库连接池\"></a>配置数据库连接池</h6><figure class=\"highlight tcl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=<span class=\"string\">&quot;1.0&quot;</span> <span class=\"keyword\">encoding</span>=<span class=\"string\">&quot;UTF-8&quot;</span>?&gt;</span><br><span class=\"line\">&lt;beans xmlns=<span class=\"string\">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class=\"line\">       xmlns:xsi=<span class=\"string\">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class=\"line\">       xmlns:context=<span class=\"string\">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class=\"line\">       xsi:schemaLocation=<span class=\"string\">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class=\"line\"><span class=\"string\">                           http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd</span></span><br><span class=\"line\"><span class=\"string\">                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span><br><span class=\"line\">    </span><br><span class=\"line\">    &lt;context:property-placeholder location=<span class=\"string\">&quot;classpath:demo4/bean/jdbc.properties&quot;</span>/&gt;</span><br><span class=\"line\">    &lt;!--配置连接池--&gt;</span><br><span class=\"line\">    &lt;bean id=<span class=\"string\">&quot;dataSource&quot;</span> class=<span class=\"string\">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>&gt;</span><br><span class=\"line\">      &lt;property name=<span class=\"string\">&quot;driverClassName&quot;</span> value=<span class=\"string\">&quot;$&#123;prop.driverClass&#125;&quot;</span>&gt;&lt;/property&gt;</span><br><span class=\"line\">      &lt;property name=<span class=\"string\">&quot;url&quot;</span> value=<span class=\"string\">&quot;$&#123;prop.url&#125;&quot;</span>&gt;&lt;/property&gt;</span><br><span class=\"line\">      &lt;property name=<span class=\"string\">&quot;username&quot;</span> value=<span class=\"string\">&quot;$&#123;prop.userName&#125;&quot;</span>&gt;&lt;/property&gt;</span><br><span class=\"line\">      &lt;property name=<span class=\"string\">&quot;password&quot;</span> value=<span class=\"string\">&quot;$&#123;prop.password&#125;&quot;</span>&gt;&lt;/property&gt;</span><br><span class=\"line\">    &lt;/bean&gt;</span><br><span class=\"line\">&lt;/beans&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;!-- 配置 JdbcTemplate 对象，注入 DataSource；JdbcTemplate 对象 --&gt;</span><br><span class=\"line\">    &lt;bean id=<span class=\"string\">&quot;jdbcTemplate&quot;</span> class=<span class=\"string\">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span><br><span class=\"line\">        &lt;!--注入 dataSource--&gt;</span><br><span class=\"line\">        &lt;property name=<span class=\"string\">&quot;dataSource&quot;</span> ref=<span class=\"string\">&quot;dataSource&quot;</span>&gt;&lt;/property&gt;</span><br><span class=\"line\">    &lt;/bean&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">// properties 配置文件中</span><br><span class=\"line\">prop.driverClass=demo4.mysql.jdbc.Driver</span><br><span class=\"line\">prop.url=jdbc:mysql://localhost:<span class=\"number\">3306</span>/userDb</span><br><span class=\"line\">prop.userName=root</span><br><span class=\"line\">prop.password=<span class=\"number\">123456</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"基于注解-XML的方式\"><a href=\"#基于注解-XML的方式\" class=\"headerlink\" title=\"基于注解 + XML的方式\"></a>基于注解 + XML的方式</h4><blockquote>\n<p>简化了xml 配置，不再需要xml ,注解可以作用在 类、方法、属性 上面</p>\n</blockquote>\n<h5 id=\"创建对象-1\"><a href=\"#创建对象-1\" class=\"headerlink\" title=\"创建对象\"></a>创建对象</h5><p><code>@Component ：将类标识为普通组件        @Service ：将类标识为业务层组件        @Controller：将类标识为控制层组件     @Repository ：将类标识为持久层组件</code></p>\n<p>​        1、@Controller、@Service、@Repository这三个注解只是在@Component注解的基础上起了三个新的名字。对于Spring使用IOC容器管理这些组件来说没有区别。所以@Controller、@Service、@Repository这三个注解只是给开发人员看的，让我们能够便于分辨组件的作用。</p>\n<p>​        2、使用注解的方式管理bean 和 使用 XML方式管理bean的时候，都应该保证每个bean都只有一个唯一标识，便于在其他地方引用。</p>\n<p>​        3、默认情况 ： 类名首字母小写就是bean的id。例如：UserController类对应的bean的id就是userController。</p>\n<p>​              自定义bean的id   ： 可通过标识组件的注解的value属性设置自定义的bean的id</p>\n<p>​                                <code>@Service(value = &quot;userservice&quot;) 「在注解里面 value 属性值可以省略不写」  // &lt;bean id = &quot;userservice&quot;&gt;&lt;/bean&gt;</code></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--开启组件扫描</span></span><br><span class=\"line\"><span class=\"comment\">     1 如果扫描多个包，多个包使用逗号隔开</span></span><br><span class=\"line\"><span class=\"comment\">     2 扫描包上层目录--&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">&quot;demo5.ry&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">context:component-scan</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">-----组件扫描的其他配置</span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 组件扫描的其他配置 --&gt;</span></span><br><span class=\"line\"> \t<span class=\"comment\">&lt;!--示例 1</span></span><br><span class=\"line\"><span class=\"comment\">     use-default-filters=&quot;false&quot; 取值false表示关闭默认扫描规则,表示现在不使用默认 filter，自己配置 filter;此时必须设置use-default-filters=&quot;false&quot;，因为默认规则即扫描指定包下所有类</span></span><br><span class=\"line\"><span class=\"comment\">     context:include-filter ，设置扫描哪些内容,指定在原有扫描规则的基础上追加的规则</span></span><br><span class=\"line\"><span class=\"comment\">\t\ttype：设置排除或包含的依据 </span></span><br><span class=\"line\"><span class=\"comment\">\t\t\ttype=&quot;annotation&quot;，根据注解排除，expression中设置要排除的注解的全类名 </span></span><br><span class=\"line\"><span class=\"comment\">\t\t\ttype=&quot;assignable&quot;，根据类型排除，expression中设置要排除的类型的全类名  --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">&quot;demo5.ry&quot;</span> <span class=\"attr\">use-default-filters</span>=<span class=\"string\">&quot;false&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">context:include-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;annotation&quot;</span>  <span class=\"attr\">expression</span>=<span class=\"string\">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">context:component-scan</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--示例 2</span></span><br><span class=\"line\"><span class=\"comment\">     下面配置扫描包所有内容</span></span><br><span class=\"line\"><span class=\"comment\">     context:exclude-filter： 设置哪些内容不进行扫描\t</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\ttype：设置排除或包含的依据 </span></span><br><span class=\"line\"><span class=\"comment\">\t\t\t\ttype=&quot;annotation&quot;，根据注解排除，expression中设置要排除的注解的全类名 </span></span><br><span class=\"line\"><span class=\"comment\">\t\t\t\ttype=&quot;assignable&quot;，根据类型排除，expression中设置要排除的类型的全类名</span></span><br><span class=\"line\"><span class=\"comment\">    --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">&quot;demo5.ry&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">context:exclude-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;annotation&quot;</span> <span class=\"attr\">expression</span>=<span class=\"string\">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h5 id=\"注入属性-1\"><a href=\"#注入属性-1\" class=\"headerlink\" title=\"注入属性\"></a>注入属性</h5><blockquote>\n<p>还是一样要开启 <code>组件扫描</code>   <code>&lt;context:component-scan base-package=&quot;demo5.ry&quot;&gt;&lt;/context:component-scan&gt;</code></p>\n</blockquote>\n<ol>\n<li><code>Autowired:根据属性类型进行自动装配(这个注解 可以标记在构造器和set方法上)</code></li>\n</ol>\n<p>Autowired 的流程：首先根据所需要的组件类型到IOC容器中查找；如果完全找不到匹配这个类型的bean：装配失败；如果和所需类型匹配的bean不止一个，就判断是否使用@Qualifier注解：根据@Autowired标记位置成员变量的变量名作为bean的id进行匹配；能够找到：执行装配，否则找不到：装配失败</p>\n<p>有使用@Qualifier注解：根据@Qualifier注解中指定的名称作为bean的id进行匹配；能够找到：执行装配；找不到：装配失败</p>\n<ol>\n<li><p><code>@Qualifier 根据名称进行注入 ，使用的时候和上面@Autowired 一起使用</code></p>\n</li>\n<li><p><code>@Resource：可以根据类型注入，可以根据名称注入</code></p>\n</li>\n<li><code>@Value：注入普通类型属性</code>   <code>@Value(value = &quot;ry&quot;)  private String  name;</code></li>\n</ol>\n<h4 id=\"完全基于注解\"><a href=\"#完全基于注解\" class=\"headerlink\" title=\"完全基于注解\"></a>完全基于注解</h4><p>和上面的区别就是  ：  在配置组件扫描的时候使用注解<code>@ComponentScan(basePackages = &#123;&quot;demo5.ry&quot;&#125;)</code>  + 新增配置类取代 xml 文件中的配置</p>\n<p><code>@Configuration // 配置类    @ComponentScan(basePackages = &#123;&quot;demo5.ry&quot;&#125;) public class SpringConfig &#123;// 配置类&#125;</code></p>\n<h3 id=\"AOP\"><a href=\"#AOP\" class=\"headerlink\" title=\"AOP\"></a>AOP</h3><ol>\n<li><p>面向切面编程：利用 AOP 可以对业务逻辑的各个部分进行隔离，从而使得业务逻辑各部分之间的耦合度降低，不通过修改源代码方式，在主干功能里面添加新功能。</p>\n</li>\n<li><p>原理依托：</p>\n<p>1 代理模式：就是通过提供一个代理类，让我们在调用目标方法的时候，不再是直接对目标方法进行调用，而是通过代理类<strong>间接</strong>调用。让不属于目标方法核心逻辑的代码从目标方法中剥离出来—<strong>解耦</strong>。调用目标方法时先调用代理对象的方法，减少对目标方法的调用，同时让附加功能能够集中在一起也有利于统一维护。</p>\n<p>2 动态代理:</p>\n<p>​     <strong>第一种</strong>有接口情况，使用 JDK 动态代理：创建接口实现类代理对象，增强类的方法</p>\n<p>​    <strong>第二种</strong>没有接口情况，使用CGLIB 动态代理：创建子类的代理对象，增强类的方法</p>\n</li>\n<li><p>术语：</p>\n</li>\n</ol>\n<p>​        1 连接点: 类里面哪些方法可以被增强，这些方法就成为连接点</p>\n<p>​        2 切入点：实际被真正增强的方法</p>\n<p>​        3 通知(增强)：实际增强的逻辑部分称为通知(增强);通知有多种类型：<strong>前置通知、后置通知、环绕通知、异常通知、最终通知</strong></p>\n<p>​        4 切面：是动作，把通知  应用到切入点的过程;</p>\n<p>​        切面优先级：<code>相同目标方法上同时存在多个切面时，切面的优先级控制切面的**内外嵌套**顺序。外&gt;内</code> ，<code>@Order(较小的数)：优先级高，@Order(较大的数)：优先级低</code></p>\n<h4 id=\"AOP操作\"><a href=\"#AOP操作\" class=\"headerlink\" title=\"AOP操作\"></a>AOP操作</h4><blockquote>\n<p>Spring 框架一般都是基于 AspectJ 实现 AOP 操作,<code>AspectJ</code>不是 Spring 组成部分，独立 AOP 框架，一般把 AspectJ 和 Spirng 框架一起使用，进行 AOP 操作</p>\n</blockquote>\n<p>AspectJ：本质上是静态代理，<strong>将代理逻辑</strong>“织入”被代理的目标类中，编译后得到的字节码文件，所以最终效果是动态的。Spring只是借用了AspectJ中的注解。</p>\n<p>切点表达式：</p>\n<p>​    1 作用：显示对哪个类里面的哪个方法进行增强</p>\n<p>​    2 语法结构：<code>execution([权限修饰符] [返回类型] [类全路径] \\[方法名称]([参数列表]) )</code></p>\n<p>​        细节：</p>\n<p>​            1 用*号代替“权限修饰符”和“返回值”部分  表示“权限修饰符”和“返回值”不限</p>\n<p>​            2 在包名的部分，一个“<em>”号只能代表包的层次结构中的一层，表示这一层是任意的;在包名的部分，使用“\\</em>..”表示包名任意、包的层次深度任意</p>\n<p>​            3 在类名的部分，类名部分整体用*号代替，表示类名任意;在类名的部分，可以使用*号代替类名的一部分</p>\n<p>​            4 在方法名部分，可以使用*号表示方法名任意; 在方法名部分，可以使用*号代替方法名的一部分</p>\n<p>​            5 在方法参数列表部分，使用(..)表示参数列表任意;在方法参数列表部分，使用(int,..)表示参数列表以一个int类型的参数开头 ;在方法参数列表部分，基本数据类型和对应的包装类型是不一样的</p>\n<p>​            6 在方法返回值部分，如果想要明确指定一个返回值类型，那么必须同时写明权限修饰符</p>\n<h4 id=\"操作举例\"><a href=\"#操作举例\" class=\"headerlink\" title=\"操作举例\"></a>操作举例</h4><h5 id=\"基于XML的方式\"><a href=\"#基于XML的方式\" class=\"headerlink\" title=\"基于XML的方式\"></a>基于XML的方式</h5><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">###### <span class=\"number\">1</span>、创建两个类，增强类和被增强类，创建方法</span><br><span class=\"line\"><span class=\"comment\">//被增强类</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Book</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">buy</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;book buy .......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//增强类</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">BookProxy</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">before</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;before ......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">###### <span class=\"number\">2</span>、在 spring 配置文件中创建两个类对象 和 切入点</span><br><span class=\"line\">  </span><br><span class=\"line\">&lt;?xml version=<span class=\"string\">&quot;1.0&quot;</span> encoding=<span class=\"string\">&quot;UTF-8&quot;</span>?&gt;</span><br><span class=\"line\">&lt;beans xmlns=<span class=\"string\">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class=\"line\">       xmlns:xsi=<span class=\"string\">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class=\"line\">       xmlns:context=<span class=\"string\">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class=\"line\">       xmlns:aop=<span class=\"string\">&quot;http://www.springframework.org/schema/aop&quot;</span></span><br><span class=\"line\">       xsi:schemaLocation=<span class=\"string\">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class=\"line\"><span class=\"string\">                            http://www.springframework.org/schema/context  http://www.springframework.org/schema/context/spring-context.xsd</span></span><br><span class=\"line\"><span class=\"string\">                            http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span><br><span class=\"line\">    </span><br><span class=\"line\">    &lt;!--创建对象--&gt;</span><br><span class=\"line\">    &lt;bean id=<span class=\"string\">&quot;book&quot;</span> class=<span class=\"string\">&quot;demo6.ry.AspectJ.Xml.Book&quot;</span>&gt;&lt;/bean&gt;</span><br><span class=\"line\">    &lt;bean id=<span class=\"string\">&quot;bookProxy&quot;</span> class=<span class=\"string\">&quot;demo6.ry.AspectJ.Xml.BookProxy&quot;</span>&gt;&lt;/bean&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;!--配置 aop 增强--&gt;</span><br><span class=\"line\">    &lt;aop:config&gt;</span><br><span class=\"line\">        &lt;!--切入点--&gt;</span><br><span class=\"line\">        &lt;aop:pointcut id=<span class=\"string\">&quot;point&quot;</span> expression=\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"string\">&quot;execution(* demo6.ry.AspectJ.Xml.Book.buy(..))&quot;</span>/&gt;</span><br><span class=\"line\">        &lt;!--配置切面--&gt;</span><br><span class=\"line\">        &lt;aop:aspect ref=<span class=\"string\">&quot;bookProxy&quot;</span>&gt;</span><br><span class=\"line\">            &lt;!--增强作用在具体的方法上--&gt;</span><br><span class=\"line\">            &lt;aop:before method=<span class=\"string\">&quot;before&quot;</span> pointcut-ref=<span class=\"string\">&quot;point&quot;</span>/&gt;</span><br><span class=\"line\">        &lt;/aop:aspect&gt;</span><br><span class=\"line\">    &lt;/aop:config&gt;</span><br><span class=\"line\">&lt;/beans&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">      </span><br><span class=\"line\"></span><br><span class=\"line\">###### <span class=\"number\">3</span>、测试代码</span><br><span class=\"line\">      </span><br><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">TestAopXml</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">ClassPathXmlApplicationContext</span> <span class=\"variable\">classPathXmlApplicationContext</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ClassPathXmlApplicationContext</span>(<span class=\"string\">&quot;demo6/ry/AspectJ/Xml/bean.xml&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Book</span> <span class=\"variable\">book</span> <span class=\"operator\">=</span> classPathXmlApplicationContext.getBean(<span class=\"string\">&quot;book&quot;</span>, Book.class);</span><br><span class=\"line\">        book.buy();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//结果</span></span><br><span class=\"line\">before ......</span><br><span class=\"line\">book buy .......</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h5 id=\"基于注解的方式\"><a href=\"#基于注解的方式\" class=\"headerlink\" title=\"基于注解的方式\"></a>基于注解的方式</h5><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">##### UserAspectJProxy最终版本应为</span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 增强方法</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"meta\">@Aspect</span></span><br><span class=\"line\"><span class=\"meta\">@Order(5)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserAspectJProxy</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Pointcut(value = &quot;execution(* demo6.ry.AspectJ.UserAspectJ.add(..))&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">pointCut</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//前置通知</span></span><br><span class=\"line\">    <span class=\"comment\">//@Before 注解表示作为前置通知</span></span><br><span class=\"line\">    <span class=\"meta\">@Before(value = &quot;pointCut()&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">before</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;before......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//后置通知</span></span><br><span class=\"line\">    <span class=\"meta\">@AfterReturning(value = &quot;execution(* demo6.ry.AspectJ.UserAspectJ.add(..))&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">afterReturning</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;AfterReturning......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//最终通知</span></span><br><span class=\"line\">    <span class=\"meta\">@After(value = &quot;execution(* demo6.ry.AspectJ.UserAspectJ.add(..))&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">after</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;after......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//异常通知</span></span><br><span class=\"line\">    <span class=\"meta\">@AfterThrowing(value = &quot;execution(* demo6.ry.AspectJ.UserAspectJ.add(..))&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">afterThrowing</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;AfterThrowing......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//环绕通知</span></span><br><span class=\"line\">    <span class=\"meta\">@Around(value = &quot;execution(* demo6.ry.AspectJ.UserAspectJ.add(..))&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">around</span><span class=\"params\">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class=\"keyword\">throws</span></span><br><span class=\"line\">            Throwable &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;环绕之前.........&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//被增强的方法执行</span></span><br><span class=\"line\">        proceedingJoinPoint.proceed();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;环绕之后.........&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">##### UserAspectJ最终版本</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component(value = &quot;userAspectJ&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserAspectJ</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">add</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;add ......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">#####  xml最终版本</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&lt;?xml version=<span class=\"string\">&quot;1.0&quot;</span> encoding=<span class=\"string\">&quot;UTF-8&quot;</span>?&gt;</span><br><span class=\"line\">&lt;beans xmlns=<span class=\"string\">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class=\"line\">       xmlns:xsi=<span class=\"string\">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class=\"line\">       xmlns:context=<span class=\"string\">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class=\"line\">       xmlns:aop=<span class=\"string\">&quot;http://www.springframework.org/schema/aop&quot;</span></span><br><span class=\"line\">       xsi:schemaLocation=<span class=\"string\">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class=\"line\"><span class=\"string\">                            http://www.springframework.org/schema/context  http://www.springframework.org/schema/context/spring-context.xsd</span></span><br><span class=\"line\"><span class=\"string\">                            http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span><br><span class=\"line\">    &lt;!-- 开启注解扫描 --&gt;</span><br><span class=\"line\">    &lt;context:component-scan base-<span class=\"keyword\">package</span>=<span class=\"string\">&quot;demo6.ry.AspectJ&quot;</span>&gt;&lt;/context:component-scan&gt;</span><br><span class=\"line\">    &lt;!-- 开启 Aspect 生成代理对象--&gt;</span><br><span class=\"line\">    &lt;aop:aspectj-autoproxy&gt;&lt;/aop:aspectj-autoproxy&gt;</span><br><span class=\"line\">&lt;/beans&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">      </span><br><span class=\"line\">##### <span class=\"number\">7</span>、测试代码</span><br><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">TestAopNAspectJ</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">   <span class=\"type\">ClassPathXmlApplicationContext</span> <span class=\"variable\">classPathXmlApplicationContext</span> <span class=\"operator\">=</span> \t\t\t\t\t\t\t\t\t\t\t<span class=\"keyword\">new</span> <span class=\"title class_\">ClassPathXmlApplicationContext</span>(<span class=\"string\">&quot;demo6/ry/AspectJ/AspectJ.xml&quot;</span>);</span><br><span class=\"line\"><span class=\"type\">UserAspectJ</span> <span class=\"variable\">userAspectJ</span> <span class=\"operator\">=</span> \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassPathXmlApplicationContext.getBean(<span class=\"string\">&quot;userAspectJ&quot;</span>, UserAspectJ.class);</span><br><span class=\"line\">            userAspectJ.add();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//结果</span></span><br><span class=\"line\">Person Before</span><br><span class=\"line\">环绕之前.........</span><br><span class=\"line\">before......</span><br><span class=\"line\">add ......</span><br><span class=\"line\">环绕之后.........</span><br><span class=\"line\">after......</span><br><span class=\"line\">AfterReturning.....</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//补充</span></span><br><span class=\"line\">##### 完全使用注解开发 ；创建配置类，不需要创建 xml 配置文件   其就是等价于xml文件的</span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@ComponentScan(basePackages = &#123;&quot;demo6.ry&quot;&#125;)</span></span><br><span class=\"line\"><span class=\"meta\">@EnableAspectJAutoProxy(proxyTargetClass = true)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ConfigAop</span> &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"bean\"><a href=\"#bean\" class=\"headerlink\" title=\"bean\"></a>bean</h3><blockquote>\n<p>1、一种<code>普通 bean(在配置文件中定义 bean 类型就是返回类型)</code></p>\n<p>2、另外一种<code>工厂 bean（FactoryBean  在配置文件定义 bean 类型可以和返回类型不一样）</code></p>\n</blockquote>\n<h5 id=\"FactoryBean\"><a href=\"#FactoryBean\" class=\"headerlink\" title=\"FactoryBean\"></a>FactoryBean</h5><ul>\n<li>是什么： 是Spring提供的一种整合第三方框架的常用机制，和普通的bean不同，配置一个FactoryBean类型的bean，在获取bean的时候得到的并不是class属性中配置的这个类的对象，而是getObject()方法的返回值。在整合Mybatis时，Spring就是通过FactoryBean机制来帮我们创建SqlSessionFactory对象的。</li>\n</ul>\n<h5 id=\"Bean-的作用域\"><a href=\"#Bean-的作用域\" class=\"headerlink\" title=\"Bean 的作用域\"></a>Bean 的作用域</h5><p>1 默认： bean 是<code>单实例对象</code></p>\n<p>2 设置<code>单实例</code>或者<code>多实例</code></p>\n<p>​    2.1 在 spring 配置文件 bean 标签里面有属性（scope）用于设置单实例(<code>singleton</code>)还是多实例(<code>prototype</code>)</p>\n<p>​    2.2 两者的区别： <code>&lt;bean id=&quot;book&quot; class=&quot;demo2.ry.collectionType.Book&quot; scope=&quot;prototype&quot;&gt;....&lt;/bean&gt;</code></p>\n<p>​        2.2.1 单实例的时候，在<code>加载spring 配置文件的时候就会创建</code>单实例对象</p>\n<p>​        2.2.2 多实例的时候，不是在加载 spring 配置文件时候创建 对象，在调用getBean 方法时候创建多实例对象</p>\n<h5 id=\"Bean的生命周期\"><a href=\"#Bean的生命周期\" class=\"headerlink\" title=\"Bean的生命周期\"></a>Bean的生命周期</h5><p>（1）通过构造器创建 bean 实例（无参数构造）<br>（2）为 bean 的属性设置值和对其他 bean 引用（调用 set 方法）<br>（3）调用 bean 的初始化的方法（需要进行配置初始化的方法）<br>（4）bean 的使用（对象获取到了）<br>（5）当容器关闭时候，调用 bean 的销毁的方法（需要进行配置销毁的方法）</p>\n<h5 id=\"bean-的后置处理器\"><a href=\"#bean-的后置处理器\" class=\"headerlink\" title=\"bean 的后置处理器\"></a>bean 的后置处理器</h5><blockquote>\n<p>bean 生命周期有七步</p>\n</blockquote>\n<p>（1）通过构造器创建 bean 实例（无参数构造）</p>\n<p>（2）为 bean 的属性设置值和对其他 bean 引用（调用 set 方法）</p>\n<p>（3）把 bean 实例传递 bean 前置处理器的方法 postProcessBeforeInitialization</p>\n<p>（4）调用 bean 的初始化的方法（需要进行配置初始化的方法）</p>\n<p>（5）把 bean 实例传递 bean 后置处理器的方法 postProcessAfterInitialization</p>\n<p>（6）bean 的使用（对象获取到了）</p>\n<p>（7）当容器关闭时候，调用 bean 的销毁的方法（需要进行配置销毁的方法）</p>\n<h3 id=\"事务\"><a href=\"#事务\" class=\"headerlink\" title=\"事务\"></a>事务</h3><p>xml文件的配置</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--jdbc.xml--&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;?xml version=<span class=\"string\">&quot;1.0&quot;</span> encoding=<span class=\"string\">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">beans</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xmlns:context</span>=<span class=\"string\">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xmlns:aop</span>=<span class=\"string\">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xmlns:tx</span>=<span class=\"string\">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">                             http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">                             http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">                             http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 数据库连接池 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;dataSource&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span> <span class=\"attr\">destroy-method</span>=<span class=\"string\">&quot;close&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;url&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;jdbc:mysql:///userdb&quot;</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;username&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;root&quot;</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;password&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;00000000&quot;</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;driverClassName&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot; &quot;</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- JdbcTemplate 对象 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;jdbcTemplate&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--注入 dataSource--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;dataSource&quot;</span> <span class=\"attr\">ref</span>=<span class=\"string\">&quot;dataSource&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 组件扫描 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">&quot;demo8.ry&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">context:component-scan</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    </span><br><span class=\"line\"> \t\t<span class=\"comment\">&lt;!--创建事务管理器--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;transactionManager&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class=\"line\">      \t<span class=\"comment\">&lt;!--注入数据源--&gt;</span></span><br><span class=\"line\">    \t\t<span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;dataSource&quot;</span> <span class=\"attr\">ref</span>=<span class=\"string\">&quot;dataSource&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--开启事务注解--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">tx:annotation-driven</span> <span class=\"attr\">transaction-manager</span>=<span class=\"string\">&quot;transactionManager&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">tx:annotation-driven</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<ol>\n<li><p>是什么：事务是数据库操作最基本单元，逻辑上一组操作，要么都成功，要么都失败</p>\n</li>\n<li><p>分类</p>\n<p>1 编程式事务：具体操作过程中，所有细节都需要程序员自己来完成；代码复用性不高</p>\n<p><code>Connection conn = ...; try &#123;// 开启事务：关闭事务的自动提交  conn.setAutoCommit(false);  // 核心操作 …… // 提交事务   conn.commit(); &#125;catch(Exception e)&#123; // 回滚事务 conn.rollBack();\n&#125;finally&#123;// 释放数据库连接 conn.close(); &#125;</code></p>\n</li>\n</ol>\n<p>​        2 声明式事务：提高开发效率、消除了冗余的代码，程序员只需要在配置文件中进行简单的配置即可完成操作</p>\n<ol>\n<li><p>声明式事务的两种管理的方式（底层依赖的是 aop原理,就是代理模式的原理）</p>\n<p>1 基于注解  <code>@Transactional</code>   这个注解添加到类上面(这个类里面所有的方法都添加事务)，也可以添加方法上面(为这个方法添加事务)</p>\n<p>2 基于xml 配置的方式</p>\n</li>\n</ol>\n<h5 id=\"Transactional-的参数配置\"><a href=\"#Transactional-的参数配置\" class=\"headerlink\" title=\"@Transactional 的参数配置\"></a><code>@Transactional</code> 的参数配置</h5><h6 id=\"事务传播行为propagation\"><a href=\"#事务传播行为propagation\" class=\"headerlink\" title=\"事务传播行为propagation\"></a>事务传播行为propagation</h6><blockquote>\n<p>当事务方法被另一个事务方法调用时，必须指定事务应该如何传播</p>\n<p>​        <img src=\"https://gitee.com/Ryang1118/typora/raw/master/images/202303051211630.bmp\" alt=\"事务传播行为\" style=\"zoom:63%;\"></p>\n</blockquote>\n<h6 id=\"事务隔离级别：ioslation\"><a href=\"#事务隔离级别：ioslation\" class=\"headerlink\" title=\"事务隔离级别：ioslation\"></a><strong>事务隔离级别：ioslation</strong></h6><blockquote>\n<p>不考虑隔离性的话会产生一些问题：</p>\n<pre><code>1. 脏读                         一个未提交事务读取到另一个未提交事务的数据\n1. 不可重复读             一个未提交事务读取到另一提交事务修改数据\n1. 虚（幻）读            一个未提交事务读取到另一提交事务添加数据\n</code></pre><p>具有隔离性的事务 ： 多事务操作之间不会产生影响</p>\n<p><img src=\"https://gitee.com/Ryang1118/typora/raw/master/images/202303051208436.bmp\" alt=\"事务隔离级别\" style=\"zoom: 63%;\"></p>\n</blockquote>\n<h6 id=\"timeout：超时时间\"><a href=\"#timeout：超时时间\" class=\"headerlink\" title=\"timeout：超时时间\"></a>timeout：超时时间</h6><blockquote>\n<p>由于某些问题导致的程序卡住，长时间占用数据库资源，此时应该对出现问题的程序进行回滚</p>\n<p>默认值是 -1 ，设置时间以秒单位进行计算</p>\n</blockquote>\n<h6 id=\"readOnly：是否只读\"><a href=\"#readOnly：是否只读\" class=\"headerlink\" title=\"readOnly：是否只读\"></a>readOnly：是否只读</h6><blockquote>\n<p>readOnly  默认值 false，表示可以查询，可以添加修改删除操作<br>readOnly 值设置为true，设置成 true 之后，只能查询,即对一个查询操作来说，如果我们把它设置成只读，就能够明确告诉数据库，这个操作不涉及写操作。这样数据库就能够针对查询操作来进行优化。</p>\n</blockquote>\n<h6 id=\"回滚策略\"><a href=\"#回滚策略\" class=\"headerlink\" title=\"回滚策略\"></a>回滚策略</h6><blockquote>\n<p>默认<code>只针对运行时</code>异常回滚，编译时异常不回滚。可以通过@Transactional中相关属性设置回滚策略:</p>\n<p>rollbackFor：回滚;   设置出现哪些异常进行事务回滚</p>\n<p>noRollbackFor：不回滚;   设置出现哪些异常不进行事务回滚</p>\n<p>​    1 rollbackFor属性：需要设置一个Class类型的对象</p>\n<p>​    2 rollbackForClassName属性：需要设置一个字符串类型的全类名</p>\n<p>​    3 norollbackForClassName属性：需要设置一个字符串类型的全类名</p>\n<p>​    3 noRollbackFor属性：需要设置一个Class类型的对象</p>\n</blockquote>\n<h4 id=\"注解的方式\"><a href=\"#注解的方式\" class=\"headerlink\" title=\"注解的方式\"></a>注解的方式</h4><p><code>@Transactional//(readOnly = false,timeout = -1,propagation = Propagation.REQUIRED,isolation = Isolation.REPEATABLE_READ)</code></p>\n<h4 id=\"完全注解的方式\"><a href=\"#完全注解的方式\" class=\"headerlink\" title=\"完全注解的方式\"></a>完全注解的方式</h4><blockquote>\n<p>创建配置类使其取代xml配置文件</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span>  <span class=\"comment\">//配置类</span></span><br><span class=\"line\"><span class=\"meta\">@ComponentScan(basePackages = &quot;demo8.ry&quot;)</span>    <span class=\"comment\">//组件扫描</span></span><br><span class=\"line\"><span class=\"meta\">@EnableTransactionManagement</span>  <span class=\"comment\">//开启事务≥lo9</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">TransactionConfig</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//创建数据库连接池</span></span><br><span class=\"line\">    <span class=\"comment\">//此段代码等价于配置文件的数据库连接池创建</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> DruidDataSource <span class=\"title function_\">getDruidDataSource</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">DruidDataSource</span> <span class=\"variable\">druidDataSource</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">DruidDataSource</span>();</span><br><span class=\"line\">        druidDataSource.setDriverClassName(<span class=\"string\">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class=\"line\">        druidDataSource.setUrl(<span class=\"string\">&quot;jdbc:mysql:///userdb&quot;</span>);</span><br><span class=\"line\">        druidDataSource.setUsername(<span class=\"string\">&quot;root&quot;</span>);</span><br><span class=\"line\">        druidDataSource.setPassword(<span class=\"string\">&quot;00000000&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> druidDataSource;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//创建JdbcTemplate对象</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> JdbcTemplate <span class=\"title function_\">getJdbcTemplate</span><span class=\"params\">(DataSource dataSource)</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">JdbcTemplate</span> <span class=\"variable\">jdbcTemplate</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">JdbcTemplate</span>();</span><br><span class=\"line\">        <span class=\"comment\">//注入dataSource</span></span><br><span class=\"line\">        jdbcTemplate.setDataSource(dataSource);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> jdbcTemplate;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//创建事务管理器的对象</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> DataSourceTransactionManager <span class=\"title function_\">getDataSourceTransactionManager</span><span class=\"params\">(DataSource dataSource)</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">DataSourceTransactionManager</span> <span class=\"variable\">dataSourceTransactionManager</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">DataSourceTransactionManager</span>();</span><br><span class=\"line\">        <span class=\"comment\">//注入dataSource</span></span><br><span class=\"line\">        dataSourceTransactionManager.setDataSource(dataSource);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> dataSourceTransactionManager;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"XML的方式\"><a href=\"#XML的方式\" class=\"headerlink\" title=\"XML的方式\"></a>XML的方式</h4><blockquote>\n<p>在Service类上不再加上  事务的注解</p>\n</blockquote>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--2 配置通知    将Spring配置文件中去掉tx:annotation-driven 标签，并添加配置：--&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- tx:advice标签：配置事务通知 --&gt;</span> </span><br><span class=\"line\"><span class=\"comment\">&lt;!-- id属性：给事务通知标签设置唯一标识，便于引用 --&gt;</span> </span><br><span class=\"line\"><span class=\"comment\">&lt;!-- transaction-manager属性：关联事务管理器 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">tx:advice</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;txadvice&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--配置事务参数--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">tx:attributes</span>&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!--指定哪种规则的方法上面添加事务--&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!-- tx:method标签：配置具体的事务方法 --&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!-- name属性：指定方法名，可以使用星号代表多个字符 --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">tx:method</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;AccountMoney&quot;</span> <span class=\"attr\">propagation</span>=<span class=\"string\">&quot;REQUIRED&quot;</span>/&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!-- read-only属性：设置只读属性 --&gt;</span> </span><br><span class=\"line\">            <span class=\"comment\">&lt;!-- rollback-for属性：设置回滚的异常 --&gt;</span> </span><br><span class=\"line\">            <span class=\"comment\">&lt;!-- no-rollback-for属性：设置不回滚的异常 --&gt;</span> </span><br><span class=\"line\">            <span class=\"comment\">&lt;!-- isolation属性：设置事务的隔离级别 --&gt;</span> </span><br><span class=\"line\">            <span class=\"comment\">&lt;!-- timeout属性：设置事务的超时属性 --&gt;</span> </span><br><span class=\"line\">            <span class=\"comment\">&lt;!-- propagation属性：设置事务的传播行为 --&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!--&lt;tx:method name=&quot;Account*&quot;/&gt;  以Account开头的方法--&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!--如--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">tx:method</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;save*&quot;</span> <span class=\"attr\">read-only</span>=<span class=\"string\">&quot;false&quot;</span> <span class=\"attr\">rollback-</span> <span class=\"attr\">for</span>=<span class=\"string\">&quot;java.lang.Exception&quot;</span> <span class=\"attr\">propagation</span>=<span class=\"string\">&quot;REQUIRES_NEW&quot;</span>/&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">tx:method</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;update*&quot;</span> <span class=\"attr\">read-only</span>=<span class=\"string\">&quot;false&quot;</span> <span class=\"attr\">rollback-</span> <span class=\"attr\">for</span>=<span class=\"string\">&quot;java.lang.Exception&quot;</span> <span class=\"attr\">propagation</span>=<span class=\"string\">&quot;REQUIRES_NEW&quot;</span>/&gt;</span></span><br><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">tx:method</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;delete*&quot;</span> <span class=\"attr\">read-only</span>=<span class=\"string\">&quot;false&quot;</span> <span class=\"attr\">rollback-</span> <span class=\"attr\">for</span>=<span class=\"string\">&quot;java.lang.Exception&quot;</span> <span class=\"attr\">propagation</span>=<span class=\"string\">&quot;REQUIRES_NEW&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">tx:attributes</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">tx:advice</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  将Spring配置文件中去掉tx:annotation-driven 标签，并添加配置：</span><br><span class=\"line\"><span class=\"comment\">&lt;!--3 配置切入点和切面--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">aop:config</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--配置切入点--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">aop:pointcut</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;pointcut&quot;</span> <span class=\"attr\">expression</span>=\t<span class=\"string\">&quot;execution(* demo8.ry.ACID.Service.UserService.*(..))&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--配置切面--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">aop:advisor</span> <span class=\"attr\">advice-ref</span>=<span class=\"string\">&quot;txadvice&quot;</span> <span class=\"attr\">pointcut-ref</span>=<span class=\"string\">&quot;pointcut&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">aop:config</span>&gt;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"Spring5-的新特性-lt-了解-gt\"><a href=\"#Spring5-的新特性-lt-了解-gt\" class=\"headerlink\" title=\"Spring5 的新特性&lt;了解&gt;\"></a>Spring5 的新特性&lt;了解&gt;</h3><h5 id=\"使用-slf4j2-的日志封装\"><a href=\"#使用-slf4j2-的日志封装\" class=\"headerlink\" title=\"使用 slf4j2 的日志封装\"></a>使用 <code>slf4j2</code> 的日志封装</h5><h5 id=\"Nullable注解：\"><a href=\"#Nullable注解：\" class=\"headerlink\" title=\"@Nullable注解：\"></a><code>@Nullable</code>注解：</h5><blockquote>\n<p>可以使用在方法上面（表示方法返回可以为空），属性上面（表示属性值可以为空），参数上面（表示参数值可以为空）</p>\n</blockquote>\n<h5 id=\"Spring5-核心容器支持函数式风格-GenericApplicationContext\"><a href=\"#Spring5-核心容器支持函数式风格-GenericApplicationContext\" class=\"headerlink\" title=\"Spring5 核心容器支持函数式风格 GenericApplicationContext\"></a>Spring5 核心容器<code>支持函数式风格</code> GenericApplicationContext</h5><h5 id=\"整合-JUnit5-单元测试框架\"><a href=\"#整合-JUnit5-单元测试框架\" class=\"headerlink\" title=\"整合 JUnit5 单元测试框架\"></a><code>整合 JUnit5 单元测试框架</code></h5><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//JUnit4 的测试框架测试用例</span></span><br><span class=\"line\"><span class=\"meta\">@RunWith(SpringJUnit4ClassRunner.class)</span>   <span class=\"comment\">//单元测试框架</span></span><br><span class=\"line\"><span class=\"meta\">@ContextConfiguration(&quot;classpath:demo8/ry/ACID/jdbc.xml&quot;)</span>  <span class=\"comment\">// 配置文件</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">JTest4</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> UserService userService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">testJunit4</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        userService.AccountMoney();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//JUnit5 的测试框架测试用例</span></span><br><span class=\"line\"><span class=\"meta\">@ExtendWith(SpringExtension.class)</span></span><br><span class=\"line\"><span class=\"meta\">@ContextConfiguration(&quot;classpath:demo8/ry/ACID/jdbc.xml&quot;)</span></span><br><span class=\"line\"><span class=\"comment\">//使用一个复合注解替代上面两个注解完成整合</span></span><br><span class=\"line\"><span class=\"meta\">@SpringJUnitConfig(locations = &quot;classpath:demo8/ry/ACID/jdbc.xml&quot;)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">JTest5</span> &#123;</span><br><span class=\"line\">  <span class=\"comment\">//同上</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h5 id=\"SpringWebflux使用\"><a href=\"#SpringWebflux使用\" class=\"headerlink\" title=\"SpringWebflux使用\"></a><code>SpringWebflux</code>使用</h5><ul>\n<li><p>是当前一种比较流行响应式编程出现的框架，一种异步非阻 塞的框架，基于 Reactor 的相关 API 实现的。</p>\n</li>\n<li><p>特点：</p>\n<ul>\n<li>非阻塞式：在有限资源下，提高系统吞吐量和伸缩性，以 Reactor 为基础实现响应式编程</li>\n<li>函数式编程：Spring5 框架基于 java8，Webflux 使用 Java8 函数式编程方式实现路由请求</li>\n</ul>\n</li>\n<li><p>和springmvc 的区别和联系</p>\n<ul>\n<li>两个框架都可以使用注解方式，都运行在 Tomet 等容器中</li>\n<li>SpringMVC 采用命令式编程，Webflux 采用异步响应式编程</li>\n</ul>\n</li>\n<li><p>Springwebflux  默认使用容器是 Netty，Netty 是高性能的 NIO 框架，异步非阻塞的框架</p>\n</li>\n<li><p>SpringWebflux 执行过程和 SpringMVC 相似的</p>\n</li>\n<li>SpringWebflux 里面 <code>DispatcherHandler</code>: 负责请求的处理  +  <code>HandlerMapping</code>：请求查询到处理的方法 +    <code>HandlerAdapter</code>：真正负责请求处理  +<code>HandlerResultHandler</code>：响应结果处理</li>\n</ul>\n<h5 id=\"SpringWebflux-实现方式\"><a href=\"#SpringWebflux-实现方式\" class=\"headerlink\" title=\"SpringWebflux 实现方式\"></a>SpringWebflux 实现方式</h5><ul>\n<li>注解编程模型    (只需要把相关依赖配置到项目中， SpringBoot 自动配置相关运行容器，默认情况下使用 Netty 服务器)</li>\n</ul>\n<blockquote>\n<ol>\n<li>SpringMVC 方式实现，同步阻塞的方式，基于 SpringMVC+Servlet+Tomcat</li>\n<li>SpringWebflux 方式实现，异步非阻塞方式，基于 SpringWebflux+Reactor+Netty</li>\n</ol>\n</blockquote>\n<ul>\n<li>函数式编程模型</li>\n</ul>\n<blockquote>\n<ol>\n<li>初始化服务器</li>\n<li>有两个核心接口：RouterFunction（实现路由功能，请求转发给对应的 handler）和HandlerFunction（处理请求生成响应的函数）。核心任务定义两个函数 式接口的实现并且启动需要的服务器。</li>\n<li>SpringWebflux 请 求 和 响 应 不 再 是 ServletRequest 和 ServletResponse ，而是 ServerRequest 和ServerResponse</li>\n</ol>\n<p>异步和同步  ： 针对调用者，调用者发送请求，如果等着对方回应之后才去做其他事情就是<code>同步</code>，如果发送请求之后不等着对方回应就去做其他事情就是<code>异步</code></p>\n<p>阻塞和非阻塞:  针对被调用者，被调用者受到请求之后，做完请求任务之后才给出反馈就是<code>阻塞</code>，受到请求之后马上给出反馈然后再去做事情就是<code>非阻塞</code></p>\n<p>响应式编程：</p>\n<ul>\n<li><p>一种是基于java 实现的：</p>\n<p>面向数据流和变化传播的编程范式，可以很方便地表达静态或动态的数据流，相关的计算模型会自动将变化的值通过数据流进行传播,会提供观察者模式的两个类  <code>Observer 和 Observable</code></p>\n</li>\n<li><p>一种是基于 Reactor 实现的:</p>\n<p>1 Reactor 有两个核心类<code>Mono 和 Flux</code> ,两个类实现接口 Publisher，提供丰富操作符（把map 元素映射为新元素 + flatMap 元素映射为流 「把每个元素转换流，把转换之后多个流合并大的流 」）。Flux 对象实现发布者，返回 N 个元素；Mono 实现发布者，返回 0 或者 1 个元素</p>\n<p>2 Flux 和 Mono 都是数据流的发布者，使用 Flux 和 Mono 都可以发出三种数据信号：<code>元素值，错误信号，完成信号</code>，错误信号和完成信号都代表终止信号，两者之间无法共存；如果没有发送任何元素值，而是直接发送错误或者完成信号，表示是空数据流 ；如果没有错误信号，没有完成信号，表示是无限数据流 ；终止信号用于告诉订阅者数据流结束了，错误信号终止数据流同时把错误信息传递给订阅者</p>\n<p>3 调用 just 或者其他方法只是声明数据流，数据流并没有发出，只有进行订阅之后才会触发数据流，不订阅什么都不会发生的</p>\n</li>\n</ul>\n</blockquote>\n","_path":"post/7f09f5da.html","_link":"http://rycan.top/post/7f09f5da.html","_id":"clo9tj5vm002zl10p56t0hu84"}}